<!DOCTYPE html>
<html>
    <head>
        <title>WebSockets - Simple chat</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/UDTheme.css">
        <link rel="stylesheet" href="css/jquery.mobile.structure-1.3.2.min.css" /> 
        <link rel="stylesheet" href="css/style.css">
        <script src="js/jquery-1.9.1.min.js"></script>
        <script src="js/jquery.mobile-1.3.1.min.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
        <script src="./js/jquery.min.js"></script>

        <script src="js/friend.js"></script>
        <script src="js/privateChat.js"></script>
        <script src="js/groupChat.js"></script>
        <script src="js/function.js"></script>
        <script src="js/group.js"></script>
        <script src="js/connectionManager.js"></script>
        <script src="js/responseManager.js"></script>
        <script src="js/applicationManager.js"></script>
        <script src="js/sendComandManager.js"></script>


        <style>
            .ui-footer {
                position: absolute;
                bottom: 0;
                width: 100%;
            }

            #chat_input{
                bottom: 0;
                display: block;
                margin: 0 -20px;
                padding: 0;
                position: absolute;
                width: 100%;

            }
            #chat_input .block-button-send{
                float: right;
                width: 90px;
            }
            #chat_input .block-input-send{
                float: right;
                margin: 3px 11px 0 0;
                min-width: 200px;
            }


            .ui-CHAT_STATUS_AVAILABLE{
                background: none repeat scroll 0 0 #00CC99;
                color: #00CC99;
            }
            .ui-CHAT_STATUS_AWAY{
                background: none repeat scroll 0 0 #00CCCC;
                color: #00CCCC;
            }
            .ui-CHAT_STATUS_DND{
                background: none repeat scroll 0 0 #FF6600;
                color: #FF6600;
            }
            .ui-CHAT_STATUS_OFFLINE{
                background: none repeat scroll 0 0 #CCCCCC;
                color: #CCCCCC;
            }
            .ui-CHAT_STATUS_INVISIBLE {
                background: none repeat scroll 0 0 #FFFF99;
                color: #FFFF99;
            }

            .ui-icon-CHAT_STATUS_AVAILABLE{
                background: url("./img/icons_online.svg") repeat scroll 0 0 transparent;
            }
            .ui-icon-CHAT_STATUS_ONLINE{
                background: url("./img/icons_online.svg") repeat scroll 0 0 transparent;
            }
            .ui-icon-CHAT_STATUS_AWAY {
                background: url("./img/icons_away.svg") repeat scroll 0 0 transparent;
            }
            .ui-icon-CHAT_STATUS_DND {
                background: url("./img/icons_emergency.svg") repeat scroll 0 0 transparent;
            }
            .ui-icon-CHAT_STATUS_BUSY {
                background: url("./img/icons_.svg") repeat scroll 0 0 transparent;
            }
            .ui-icon-CHAT_STATUS_INVISIBLE {
                background: url("./img/icons_invisible.svg") repeat scroll 0 0 transparent;
            }
            .ui-icon-CHAT_STATUS_OFFLINE {
                background: url("./img/icons.svg") repeat scroll 0 0 transparent;
            }

            #chatListT .ui-li-icon{
                left: 0;
                max-height: 30px;
                min-width: 30px;
                top: 5px;
            }
            #contactListT .ui-li-icon, #contactList-selectedFriendT .ui-li-icon{
                left: 0;
                max-height: 30px;
                min-width: 30px;
                top: -2px;
            }
            .ui-li-message-count {
                background: none repeat scroll 0 0 lightgreen;
                border-radius: 1em 1em 1em 1em;
                color: white;
                margin: 0 6px;
                padding: 1px 6px;
                position: absolute;
            }
            .ui-li-message-text {
                font-size: 11pt;
                padding-left: 20px;
            }
            .chat-list-friend-item{
                margin: -3px 0 0;
            }

            .ui-selectedFriend{
                /*z-index: 1;
                box-shadow: 0 0 3px #387BBE inset, 0 0 9px #387BBE;*/
                display: none;
            }
            #contactPageSmallMenu{
                display: none;
                margin: 15px -15px;
            }

            #contactPageSmallMenu li {
                margin-bottom: 18px;
            }


            .user-status-icon {
                font-family: SSPika;
                position: absolute;
                right: 10px;
                top: 35%;
            }



            .hidden {
                display: none;
            }

            #chatBack, #contactback {
                background: url("./img/icons.svg") no-repeat scroll -115px 0 / 240px auto transparent;
                border: medium none;
                border-radius: 0 0 0 0;
                box-shadow: none;
                height: 18px;
                left: 10px;
                text-decoration: none;
                top: 33%;
                width: 18px;
            }
            #chatBack{
                background-position: -45px -21px;
                width: 19px;
            }
            .ui-controlgroup-controls{
                font-family: SSPika; 
            }


            #contactLink {
                background: url("./img/icons.svg") no-repeat scroll -94px -20px / 240px auto transparent;
                height: 20px;
                position: absolute;
                right: 25px;
                top: 50%;
                width: 19px;
            }
            #infoPrivateChat {
                background: url("./img/icons.svg") no-repeat scroll -26px -20px / 240px auto transparent;
                height: 20px;
                position: absolute;
                right: 25px;
                top: 50%;
                width: 19px;
            }
            #statusLinkMainPage, #statusLinkChat{
                border-radius: 16px 16px 16px 16px;
                display: block;
                height: 18px;
                position: absolute;
                right: 0;
                top: 50%;
                width: 18px;       
            }
            #statusLinkContatct {
                border: medium none;
                border-radius: 16px 16px 16px 16px;
                box-shadow: none;
                display: block;
                height: 18px;
                right: 10px;
                top: 33%;
                width: 18px;
            }

            .ui-body-c, .ui-overlay-c {
                background: #FFFFFF;
                color:green;


            }
            #chatListT li {
                height: 40px;
            }
            #chatListT li a {
                font-size: 13pt;
                font-weight: normal;
                padding: 0 0 0 35px;
            }
            #contactListT li, #contactList-selectedFriendT li {
                height: 30px;
            }
            #contactListT li a, #contactList-selectedFriendT li a {
                font-size: 13pt;
                font-weight: normal;
                padding: 4px 0 0 35px;
            }

            .device-mobile {
                background-position: 0 0;
                background-size: 190px auto;
                height: 16px;
                width: 11px;
            }
            .device-tablet {
                background-position: -134px -16px;
                background-size: 190px auto;
                height: 16px;
                width: 16px;
            }
            .device-pc {
                background-position: -132px 0px;
                background-size: 190px auto;
                height: 15px;
                width: 16px;
            }

            .user-delet-icon {
                background: url("./img/icons.svg") repeat scroll -83px 0 / 150px auto transparent;
                height: 11px;
                position: absolute;
                right: 10px;
                top: 0;
                width: 9px;
            }
            #contactList-selectedFriendT .user-status-icon {
                background-size: 150px auto;
                height: 12px;
                top: 14px;
                width: 9px;
            }


            .smallMenuBtn {
                background: url("./img/icons.svg") repeat scroll -197px -20px / 250px auto transparent;
                border: medium none;
                border-radius: 0 0 0 0;
                box-shadow: none;
                display: block;
                height: 20px;
                margin: 0 auto;
                width: 19px;
            }
            #contactPageSmallMenu a {
                padding: 4px 0;
            }

            /******************************************************
            *   contact list search filter
            *******************************************************/

            .ui-listview-filter {
                background: none repeat scroll 0 0 white;
            }

            .ui-input-search {
                border: medium none;
                box-shadow: none;
            }
            .ui-icon-searchfield:after{
                background: none;
            }
            #contactPage .ui-icon-delete {
                background: url("./img/icons.svg") repeat scroll -139px 0 / 250px auto transparent;
                border: medium none;
                border-radius: 0 0 0 0;
                margin: 1px 5px;
                width: 14px;
            }
            #contactPage form a {
                background: none;
                border: none;
            }

            #contactPage .ui-input-search.ui-focus{
                box-shadow: none;
            }

            /*********************************************************************************************************/

            /******************************************************
            *   chat page footer
            *******************************************************/

            .block-input-send .ui-input-text {
                background: none;
                box-shadow: none;
                border: none;
            }

            .block-button-send .ui-btn {
                background: url("./img/icons.svg") repeat scroll -118px -20px / 250px auto transparent;
                border: medium none;
                border-radius: 0 0 0 0;
                box-shadow: none;
                height: 21px;
                margin: 0;
                padding: 0;
                width: 20px;
            }

            .block-button-send{
                float: right;
                margin: 16px 22px 0 0;
            }
            .block-input-send{
                float: left;
                margin-left: 8px;

            }
            /*********************************************************************************************************/
            /*.profilImg{
                width: 30px;
                height: 30px;
            }*/
        </style>
    </head>

    <body id="body">


        <div data-role="page" id="loginPage" data-theme="d">


            <div data-role="content">
                <p>
                    <input type="text" id="loginI" value="conan@cd.ef"/>
                    <input type="password" id="passwordI" value="123"/>
                    <button onclick="login($('#loginI').val(), $('#passwordI').val(), 'CHAT_STATUS_ONLINE');" id="loginButton">Login</button>
                    <span id="connectionON">Status...</span>                    
                </p>

            </div>

        </div>





        <div data-role="page" id="mainPage" data-theme="d">
            <div data-role="header" data-theme="d">
                <h1 id="mainPageHeadT">Chat</h1>  
                <!-- <button onclick="logout();">Logout</button> -->
                <div data-type="horizontal" data-role="controlgroup" class="ui-btn-right">
                    <a id="contactLink" onclick="onOpenContactList();"  href="" data-inline="true"></a>
                    <a id="statusLinkMainPage"  href="#popupMenu" data-rel="popup" data-inline="true" data-transition="slidedown" data-icon="CHAT_STATUS_AVAILABLE" class="ui-CHAT_STATUS_AVAILABLE"></a>
                </div>
            </div>

            <div data-role="content" data-theme="d">
                <ul data-role="listview" id="chatListT">
                    <li class="ui-li ui-li-static ui-btn-up-c">test :message</li>
                </ul>

                <div data-role="popup" id="popupMenu">
                    <ul data-role="listview" data-inset="true" style="min-width:210px;" >
                        <li data-role="divider" data-theme="e">Choose status</li>
                        <li data-icon="false"><a onclick="setStatus(available);" href="#" data-rel="back">available</a></li>
                        <li data-icon="false"><a onclick="setStatus(away);" href="#" data-rel="back">away</a></li>
                        <li data-icon="false"><a onclick="setStatus(emergency);" href="#" data-rel="back">emergency</a></li>
                        <li data-icon="false"><a onclick="setStatus(invisible);" href="#" data-rel="back">invisible</a></li>
                        <li data-icon="false"><a onclick="setStatus(ofline);" href="#" data-rel="back">ofline</a></li>  
                    </ul>
                </div>
            </div>


        </div>

        <div data-role="page" id="contactPage" data-theme="d">
            <div data-role="header" data-theme="d">
                <h1 id="contactT">Connections</h1>  
                <!-- <button onclick="logout();">Logout</button> -->
                <a id="contactback" onclick="onGoToMainPage();"  href=""  data-inline="true"></a>
                <a id="statusLinkContatct"  href="#popupMenu2" data-rel="popup"  data-inline="true" data-transition="slidedown" class="ui-CHAT_STATUS_AVAILABLE"></a>

            </div>

            <div data-role="content">
                <ul id="contactList-selectedFriendT" data-role="listview" class="ui-listview">

                </ul>
                <ul data-role="listview" id="contactPageSmallMenu">
                    <li data-icon="false"><a onclick="openPGChat(user.name);" href=""><span class="smallMenuBtn"></span></a></li>
                </ul>

                <ul data-role="listview" id="contactListT" data-filter="true" data-theme="d"></ul>

                <div data-role="popup" id="popupMenu2">
                    <ul data-role="listview" data-inset="true" style="min-width:210px;" >
                        <li data-role="divider" data-theme="e">Choose status</li>
                        <li data-icon="false"><a onclick="setStatus(available);" href="#" data-rel="back">available</a></li>
                        <li data-icon="false"><a onclick="setStatus(away);" href="#" data-rel="back">away</a></li>
                        <li data-icon="false"><a onclick="setStatus(emergency);" href="#" data-rel="back">emergency</a></li>
                        <li data-icon="false"><a onclick="setStatus(invisible);" href="#" data-rel="back">invisible</a></li>
                        <li data-icon="false"><a onclick="setStatus(ofline);" href="#" data-rel="back">ofline</a></li>  
                    </ul>
                </div>
            </div>


        </div>

        <div data-role="page" id="chatPageTemplate" data-theme="d">
            <div data-role="header" data-position="fixed" data-theme="d">
                <h1 id="chatPageTitle">Text chat</h1>  


                <a id="chatBack" onclick="onGoToMainPage();"  href=""  data-inline="true"></a>
                <div data-type="horizontal" data-role="controlgroup" class="ui-btn-right">
                    <a id="infoPrivateChat" onclick="onOpenContactList();"  href="" data-inline="true"></a>
                    <a id="statusLinkChat"     href="#popupMenu3" data-rel="popup" data-inline="true" data-transition="slidedown" data-icon="CHAT_STATUS_AVAILABLE" class="ui-CHAT_STATUS_AVAILABLE"></a>
                </div>
                

            </div>

            <div data-role="content">
                <ul data-role="listview" id="chatHistory">                        
                </ul>
                <!--<div id="chat_input">
                    <div class="block-button-send"><button onclick="sendPrivateMessage($('#inputPrivateMessage').val());">send</button></div>
                    <div class="block-input-send"><input type="text" id="inputPrivateMessage"/></div>
                </div>-->

                <div data-role="popup" id="popupMenu3">
                    <ul data-role="listview" data-inset="true" style="min-width:210px;" >
                        <li data-role="divider" data-theme="e">Choose status</li>
                        <li data-icon="false"><a onclick="setStatus(available);" href="#" data-rel="back">available</a></li>
                        <li data-icon="false"><a onclick="setStatus(away);" href="#" data-rel="back">away</a></li>
                        <li data-icon="false"><a onclick="setStatus(emergency);" href="#" data-rel="back">emergency</a></li>
                        <li data-icon="false"><a onclick="setStatus(invisible);" href="#" data-rel="back">invisible</a></li>
                        <li data-icon="false"><a onclick="setStatus(ofline);" href="#" data-rel="back">ofline</a></li>  
                    </ul>
                </div>
            </div>

            <div data-role="panel" id="right-panel" data-display="overlay" data-position="right" data-theme="d">
                <div class="ui-panel-inner">
                    <ul data-role="listview" data-theme="d" data-icon="false">
                        <li data-icon="delete"><a href="#" data-rel="close"></a></li>
                        <li><a onclick="closePrivateChat(getActiveConverastion());" href="#">Close this converastion</a></li>                 
                    </ul>
                </div>
            </div><!-- /panel -->

            <div data-role="footer" data-position="fixed" data-theme="d">
                <div class="block-input-send"><input type="text" id="inputPrivateMessage"/></div>
                <div class="block-button-send"><button onclick="sendPrivateMessage($('#inputPrivateMessage').val());"></button></div>
            </div>
        </div>




        <div data-role="page" id="groupChatPageTemplate">
            <div data-role="header" data-position="fixed">
                <h1 id="groupChatPageT"></h1>  
                <button onclick="onGoToMainPage();">Back</button>
                <a href="#groupRight-panel" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a>
            </div>

            <div data-role="content">
                <ul data-role="listview" id="groupChatHistory">                        
                </ul>
            </div>

            <div data-role="panel" id="groupRight-panel" data-display="overlay" data-position="right" data-theme="c">
                <div class="ui-panel-inner">
                    <ul data-role="listview" data-theme="d" data-icon="false">
                        <li data-icon="delete"><a href="#" data-rel="close"></a></li>
                        <li><a onclick="closeGroupChat(getActiveGroupChat());" href="#">Close this group</a></li>                 
                    </ul>
                </div>
            </div><!-- /panel -->

            <div data-role="footer" data-position="fixed">
                <div class="block-input-send"><input type="text" id="groupInputPrivateMessage"/></div>
                <div class="block-button-send"><button onclick="sendGroupMessage(getActiveGroupChat(), $('#groupInputPrivateMessage').val());">send</button></div>
            </div>
        </div>

        <div data-role="page" id="chatPage">
            <div data-role="header">
                <h1>Chat window</h1>  
                <button onclick="logout();">Logout</button>
            </div>

            <div data-role="content">
                <ul data-role="listview" id="messageArray" data-theme="e">
                    <li class="ui-li ui-li-static ui-btn-up-c">test :messafe</li>
                </ul>
                <p>
                    <input type="text" id="input"/>

                    <button onclick="openPrivateChat(8);">Open chat</button>
                    <button onclick="closePrivateChat(8);">Close chat</button>

                    <button onclick="openGroupChat('test G1');">Open group</button>
                    <button onclick="closeGroupChat(7551);">Close group 7551</button>
                    <button onclick="addUserToGroup(8, 4194);">Add user 8 to group 4194</button>

                    <button onclick="leaveConversation(3751);">Leave conver 3751</button>

                    <button onclick="sendGroupMessage(4194, 'test message from web to group');">send mess to 4194</button>


                </p>

            </div>
        </div>

    </body>
</html>